# Оператор
## Назначение
Оператор заменяет стандартный компонент Citadel платформы Istio и предназначен для обеспечения безопасного взаимодействия между микросервисами, запущенными на платформе. Оператор позволяет генерировать сертификаты для безопасного взаимодействия между микросервисами и управлять ими. Кроме того, обеспечивает шифрование трафика между микросервисами, их аутентификацию и авторизацию.
_<Я считаю, что здесь необходимо было отразить преимущества этого варианта перед стадартным компонентом Citadel, но информацию о них не получила.>_
## Установка 
В команде установке оператора вам необходимо указать значения параметров, которые описаны в таблице ниже.

|**Параметр**|**Описание**|**Значение по умолчанию**|
|-----------|-----------|------------------------|
|appVersion |Версия и тег образа Docker |2023.2.1-dev |
|acm.caroot |Содержимое корневого сертификата. Вы можете использовать синтаксис bash для его получения. Например, "$(cat ~/Root_CA.pem)" |— |
|cluster.name |Имя кластера, в котором будет установлен оператор |— |
|cluster.environment |Переменные окружения, которые будут использоваться контейнером с оператором. Возможные значения: DEV, TEST, PROD. Указывать переменные окружения необязательно _<Здесь я тоже не получила информации о том, почему в примере команды этого параметра нет, а в описании — есть. Поэтому предположила, что параметр необязательный.>_ |— | 
|acm.configServers |Список серверов поставщиков конфигураций в формате {URL1,...,URLN} |— |

**Чтобы установить оператор:**

1. Создайте пространство имен (namespace), выполнив команду:
```bash
kubectl create namespace itcacm-citadel-system
```
2. Установите оператор, с помощью команды helm upgrade. Например:
```bash
helm upgrade -f ./chart/cr.yandex.yaml --install acmistio --namespace itcacm-citadel-
system --set acm.caroot="(cat ~/Root_CA.pem)" --set cluster.name=cwi-prod-1 --set
image.appVersion=2023.2.1-dev --set acm.configServers=\"{https://p0esau-
ap2301wn.domain.ru/api/acmcd,https://p0esau-ap2302lk.domain.ru/api/acmcd}\" ./chart

```
3. Сгенерируйте сертификат для оператора, выполнив команду:
```bash
kubectl apply -f ./config/samples/istiod-autocert.yaml -n istio-system
```
4. Замените стандартный компонент Citadel, выполнив команду:
```bash
kubectl apply -f ./config/samples/istio-config-1.12.2.yaml
```

_<Не получила информации о том, как проверить успешность установки и к каким инструкциям нужно перейти. Но в реальных задачах это важно.>_
